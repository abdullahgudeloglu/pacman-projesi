<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Abdullah'ın Modern Pacman Oyunu</title>
    <style>
        body {
            background-color: #111;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        h2 {
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 0, 0.7);
        }
        canvas {
            background-color: #000;
            border: 4px solid #333;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
            border-radius: 10px;
        }
        .info {
            margin-top: 15px;
            color: #aaa;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <h2>PACMAN ARENA</h2>
    <canvas id="oyunEkrani" width="600" height="600"></canvas>
    <div class="info">Yön tuşlarıyla kaç, hayaletlere yakalanma! | Yeniden Başlatmak için: ENTER</div>

<script>
    const canvas = document.getElementById("oyunEkrani");
    const ctx = canvas.getContext("2d");

    // Oyun Durumu
    let isGameOver = false;
    let score = 0;

    // Pacman Nesnesi
    let pacman = {
        x: 300,
        y: 300,
        size: 15,
        speed: 5,
        mouthOpen: 0.2,
        mouthSpeed: 0.05,
        angle: 0, 
        nextX: 0,
        nextY: 0
    };

    // Tuş Kontrolü
    let keys = {};

    // Düşmanlar (Hayaletler)
    let ghosts = [];

    function initGhosts() {
        // HIZ AYARLARI BURADA YAPILDI (Daha yavaşlar)
        ghosts = [
            { x: 50, y: 50, color: "red", speed: 1.0, vx: 1, vy: 1 },    // Çok Yavaş
            { x: 550, y: 50, color: "pink", speed: 1.5, vx: -1, vy: 1 }, // Orta
            { x: 50, y: 550, color: "cyan", speed: 2.0, vx: 1, vy: -1 }  // Biraz Hızlı
        ];
    }
    
    // Yem
    let food = {
        x: Math.random() * (canvas.width - 40) + 20,
        y: Math.random() * (canvas.height - 40) + 20,
        size: 6,
        color: "#ffb897"
    };

    // Tuş Dinleyicileri
    window.addEventListener("keydown", function(e) {
        keys[e.key] = true;
        if (isGameOver && e.key === "Enter") {
            resetGame();
        }
    });
    window.addEventListener("keyup", function(e) {
        keys[e.key] = false;
    });

    function resetGame() {
        pacman.x = 300;
        pacman.y = 300;
        score = 0;
        isGameOver = false;
        initGhosts();
        gameLoop();
    }

    // Oyun Mantığı Güncelleme
    function update() {
        if (isGameOver) return;

        // Pacman Hareketi
        if (keys["ArrowUp"] && pacman.y > pacman.size) {
            pacman.y -= pacman.speed;
            pacman.angle = -Math.PI / 2;
        }
        else if (keys["ArrowDown"] && pacman.y < canvas.height - pacman.size) {
            pacman.y += pacman.speed;
            pacman.angle = Math.PI / 2;
        }
        else if (keys["ArrowLeft"] && pacman.x > pacman.size) {
            pacman.x -= pacman.speed;
            pacman.angle = Math.PI;
        }
        else if (keys["ArrowRight"] && pacman.x < canvas.width - pacman.size) {
            pacman.x += pacman.speed;
            pacman.angle = 0;
        }

        // Ağız Animasyonu
        pacman.mouthOpen += pacman.mouthSpeed;
        if (pacman.mouthOpen > 0.25 || pacman.mouthOpen < 0.02) {
            pacman.mouthSpeed = -pacman.mouthSpeed;
        }

        // Yem Yeme
        let dx = pacman.x - food.x;
        let dy = pacman.y - food.y;
        let distance = Math.sqrt(dx * dx + dy * dy);

        if (distance < pacman.size + food.size) {
            score += 10;
            food.x = Math.random() * (canvas.width - 40) + 20;
            food.y = Math.random() * (canvas.height - 40) + 20;
            
            // Her 50 puanda hayaletler ÇOK AZ hızlansın (Eskiden 0.5 idi, şimdi 0.2)
            if (score % 50 === 0) {
                ghosts.forEach(g => {
                    g.speed += 0.2;
                });
            }
        }

        // Hayalet Hareketi
        ghosts.forEach(ghost => {
            if (pacman.x > ghost.x) ghost.x += ghost.speed * 0.6;
            else ghost.x -= ghost.speed * 0.6;
            
            if (pacman.y > ghost.y) ghost.y += ghost.speed * 0.6;
            else ghost.y -= ghost.speed * 0.6;

            let gDx = pacman.x - ghost.x;
            let gDy = pacman.y - ghost.y;
            let gDist = Math.sqrt(gDx * gDx + gDy * gDy);

            if (gDist < pacman.size + 15) {
                isGameOver = true;
            }
        });
    }

    // Çizim İşlemleri
    function draw() {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Yem
        ctx.fillStyle = food.color;
        ctx.beginPath();
        ctx.arc(food.x, food.y, food.size, 0, Math.PI * 2);
        ctx.shadowBlur = 10;
        ctx.shadowColor = "white";
        ctx.fill();
        ctx.shadowBlur = 0;

        // Pacman
        ctx.save();
        ctx.translate(pacman.x, pacman.y);
        ctx.rotate(pacman.angle);
        
        ctx.fillStyle = "yellow";
        ctx.beginPath();
        ctx.arc(0, 0, pacman.size, pacman.mouthOpen * Math.PI, (2 - pacman.mouthOpen) * Math.PI);
        ctx.lineTo(0, 0);
        ctx.fill();
        ctx.restore();

        // Hayaletler
        ghosts.forEach(ghost => {
            ctx.fillStyle = ghost.color;
            ctx.beginPath();
            ctx.arc(ghost.x, ghost.y, 15, Math.PI, 0); 
            ctx.lineTo(ghost.x + 15, ghost.y + 15);
            ctx.lineTo(ghost.x - 15, ghost.y + 15);
            ctx.fill();
            
            ctx.fillStyle = "white";
            ctx.beginPath();
            ctx.arc(ghost.x - 5, ghost.y - 2, 4, 0, Math.PI * 2);
            ctx.arc(ghost.x + 5, ghost.y - 2, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = "black";
            ctx.beginPath();
            ctx.arc(ghost.x - 5, ghost.y - 2, 2, 0, Math.PI * 2);
            ctx.arc(ghost.x + 5, ghost.y - 2, 2, 0, Math.PI * 2);
            ctx.fill();
        });

        // Skor
        ctx.fillStyle = "white";
        ctx.font = "bold 20px Consolas";
        ctx.fillText("SKOR: " + score, 15, 30);

        // Game Over
        if (isGameOver) {
            ctx.fillStyle = "rgba(0, 0, 0, 0.7)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = "red";
            ctx.font = "bold 50px Verdana";
            ctx.textAlign = "center";
            ctx.fillText("GAME OVER", canvas.width/2, canvas.height/2);
            
            ctx.fillStyle = "white";
            ctx.font = "20px Verdana";
            ctx.fillText("Yeniden başlamak için ENTER'a bas", canvas.width/2, canvas.height/2 + 40);
            ctx.textAlign = "start";
        }
    }

    function gameLoop() {
        update();
        draw();
        if (!isGameOver) {
            requestAnimationFrame(gameLoop);
        } else {
            draw(); 
        }
    }

    initGhosts();
    gameLoop();

</script>

</body>
</html>
